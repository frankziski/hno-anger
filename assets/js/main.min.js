"use strict";


var doc = document.documentElement;
var w = window;

var prevScroll = w.scrollY || doc.scrollTop;
var curScroll;
var direction = 0;
var prevDirection = 0;

var header = document.getElementById('navbar');
var offcanvas = document.getElementById('offcanvasNavbar');

var checkScroll = function(init=false) {
    curScroll = w.scrollY || doc.scrollTop;

    if (init == true && curScroll > 0) {
        toggleHeader(2, curScroll, true)
    } else if (curScroll > prevScroll) { 
        //scrolled down
        direction = 2;
        header.classList.remove('up');

        if (direction !== prevDirection) {
            toggleHeader(direction, curScroll);
        }
    } else if (curScroll < prevScroll) { 
        //scrolled up
        direction = 1;

        toggleHeader(direction, curScroll);
    }

    prevScroll = curScroll;
};

var toggleHeader = function (direction, curScroll, init=false) {
    if (!offcanvas.classList.contains('show')) {
        if (direction === 2 && curScroll > 80) {       
            header.classList.add('scrolled');
            prevDirection = direction;
        }
        else if (direction == 2 && init == true) {
            header.classList.add('scrolled');
            prevDirection = direction;
        }
        else if (direction === 1) {
            if (curScroll <= 80) {
                header.classList.remove('scrolled');
                header.classList.remove('up');
                prevDirection = direction;
            } else {
                header.classList.add('up');
            }
        }
    }
};

window.addEventListener('scroll', checkScroll); 

//doc loaded
window.addEventListener('load', function () {
    // Set Viewport Height for Calculating 100vh in css
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);

    Array
    .from(document.getElementsByClassName("icon-search"))
    .forEach((function (e) {
        e.addEventListener("click", (function () {
            Array
                .from(document.getElementsByClassName("search"))
                .forEach((function (e) {
                    e
                        .classList
                        .toggle("active")
                })),
            Array
                .from(document.getElementsByClassName("search-overlay"))
                .forEach((function (e) {
                    e
                        .classList
                        .toggle("active")
                })),
            Array
                .from(document.getElementsByClassName("page"))
                .forEach((function (e) {
                    e
                        .classList
                        .remove("no-scroll")
                })),
            document
                .getElementById("search")
                .focus()
        }))
    })),
        
    Array
        .from(document.getElementsByClassName("search-overlay"))
        .forEach((function (e) {
            e.addEventListener("click", (function () {
                Array
                    .from(document.getElementsByClassName("search"))
                    .forEach((function (e) {
                        e
                            .classList
                            .toggle("active")
                    })),
                Array
                    .from(document.getElementsByClassName("search-overlay"))
                    .forEach((function (e) {
                        e
                            .classList
                            .toggle("active")
                    })),
                Array
                    .from(document.getElementsByClassName("header-main"))
                    .forEach((function (e) {
                        e
                            .classList
                            .remove("hide")
                    }))
            }))
        })),

    // Lightbox
    Array.from(document.querySelectorAll("[data-lightbox]")).forEach(element => {
        element.onclick = (e) => {
            e.preventDefault();
            basicLightbox.create(`<img src="${element.href}">`).show();
        };
    });



    // Modal
    Array.from(document.querySelectorAll(".modal")).forEach(element => {
        document.body.appendChild(element);
    });

    checkScroll(true);
}, false);

// Video Controls
function playButtonClicked(elemID) {
    var video = document.getElementById('video-'+elemID);
                
    if (video.paused) {
        video.play();
    } else {
        video.pause();
    }
}

function videoOnPlay(elemID) {
    var video = document.getElementById('video-'+elemID);
    var button = document.getElementById('play-'+elemID);

    button.classList.add("running");
    button.classList.add("started");
    video.classList.add("running");

    button.classList.remove("paused");
    video.classList.remove("paused");
}

function videoOnStop(elemID) {
    var video = document.getElementById('video-'+elemID);
    var button = document.getElementById('play-'+elemID);

    button.classList.remove("running");
    video.classList.remove("running");

    button.classList.add("paused");
    video.classList.add("paused");
}
  
const $body = document.querySelector('body');
$body.addEventListener('cookies:saved', function(event) {
    location.reload();
})